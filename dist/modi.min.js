!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Modi",[],t):"object"==typeof exports?exports.Modi=t():e.Modi=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(1),l=i(r),o=n(2),u=i(o),c=n(3),d=i(c),h="modal",f=function(){function e(t,n){s(this,e),t=t||{},this.config=Object.assign({container:document.body,content:null,template:null,data:Object.assign({},t.data)},t),this.template=new u.default(this.config.template||d.default,this.config.data),l.default.container=this.config.container,this.elements=[],this.references={},this.listeners=[],!1!==n&&this.create(this.config.content)}return a(e,[{key:"show",value:function(e,t){this.setVisible(!0,t,e)}},{key:"hide",value:function(e){this.setVisible(!1,e)}},{key:"setVisible",value:function(e,t,n){if(this.elements.length){var i=!0===e?"show":"hide";!0!==t&&this.template.methods[i]?"show"===i?this.template.methods.show(n,this):this.template.methods.hide(this):e!==this.isVisible()&&("show"===i&&n&&(this.content=n),this.setFlags(e),this.dispatchEvent(this.element(h),"modal:"+i))}}},{key:"relocate",value:function(){this.isVisible()&&(this.setFlags(),this.dispatchEvent(this.element(h),"modal:relocate"))}},{key:"create",value:function(e){var t=this;this.elements.length||(this.elements=l.default.appendHtml(this.template.render()),this.elements.forEach(function(e){Object.defineProperty(e,"_Modi",{value:t})}),this.content=e||"",this.element("close")&&this.addListener(this.element("close"),"click",function(){t.hide()}),"true"===l.default.data.get(this.element("overlay"),"outsideClose")&&this.addListener(this.element("overlay"),"click",function(e){"overlay"===e.target.dataset.element&&t.hide()}),this.resizeTimer=null,this.addListener(window,"resize",function(){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){t.relocate()},300)}),this.template.hasEvents()&&this.template.events.forEach(function(e){var n=l.default.getByAttr(e.selector,t.element(h))[0];n&&t.addListener(n,e.type,function(){-1!==["overlay","modal"].indexOf(e.dispatcher)&&(n=t.element(e.dispatcher)),t.dispatchEvent(n,e.name)})}))}},{key:"remove",value:function(){this.hide(),this.listeners.forEach(function(e){e.element.removeEventListener(e.type,e.listener)}),this.elements.forEach(function(e){l.default.container.removeChild(e)}),this.elements=[],this.references={}}},{key:"isVisible",value:function(){return"true"===l.default.data.get(this.element(h),"visible")}},{key:"element",value:function(e){var t=this;return this.references[e]||(this.references[e]=this.elements.filter(function(t){return t.dataset.element===e})[0]||this.elements.map(function(n){return t.getSubElement(e,n)})[0]||this.getSubElement(e,l.default.container)),this.references[e]}},{key:"getSubElement",value:function(e,t){return l.default.getByAttr('[data-element="'+e+'"]',t)[0]}},{key:"setFlags",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.isVisible(),n=!1,i=!1;["overlay",h].forEach(function(n){l.default.data.set(e.element(n),"visible",t)}),l.default.data.set(l.default.container,"modalVisible",t),this.element(h)&&(n=window.innerHeight<this.element(h).offsetHeight,i=parseInt(this.element(h).dataset.smallWidth||0,10),i=i>0&&window.matchMedia("(max-width: "+i+"px)").matches),["overlay",h].forEach(function(t){l.default.data.set(e.element(t),"smallHeightFlag",n),l.default.data.set(e.element(t),"smallWidthFlag",i)})}},{key:"addListener",value:function(e,t,n){e&&(e.addEventListener(t,n),this.listeners.push({element:e,type:t,listener:n}))}},{key:"dispatchEvent",value:function(e,t,n){e&&(n=Object.assign({instance:this,overlay:this.element("overlay"),modal:this.element(h)},n),this.template.listeners[t]&&this.template.listeners[t](n),l.default.event.dispatch(e,t,n))}},{key:"content",get:function(){return this.element("content")?this.element("content").innerHTML:void 0},set:function(e){e&&this.element("content")&&(this.element("content").innerHTML=e)}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={container:document.body,stringToElements:function(e){var t=document.createElement("div");return t.innerHTML=e,t.children},appendElements:function(e,t){var n=[].slice.call(e),i=document.createDocumentFragment();return Array.from(e).forEach(function(e){i.appendChild(e)}),(t||this.container).appendChild(i),n},appendHtml:function(e,t){return this.appendElements(this.stringToElements(e),t)},getByAttr:function(e,t){return t=t||this.container,t.querySelectorAll(e)},getSiblings:function(e){var t=[],n=!0,i=!1,s=void 0;try{for(var a,r=e.parentNode.children[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var l=a.value;!1===e.isEqualNode(l)&&t.push(l)}}catch(e){i=!0,s=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw s}}return t},style:{set:function(e,t,n){e.style.setProperty(t,n)},remove:function(e,t){e.style.removeProperty(t)}},event:{dispatch:function(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:n}))}},data:{get:function(e,t){return(e||{}).dataset?e.dataset[t]:void 0},set:function(e,t,n){(e||{}).dataset&&(e.dataset[t]=n)}}},e.exports=t.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t,n){i(this,e),this.html=t.html||"",this.data=Object.assign({},t.data,n),this.events=t.events||{},this.listeners=t.listeners||{},this.methods=t.methods||{}}return s(e,[{key:"hasEvents",value:function(){return this.events.constructor===[].constructor&&this.events.length}},{key:"render",value:function(){return this.build(this.html,this.data)}},{key:"build",value:function(e,t){return e.replace(/{([^{}]+)}/g,function(e,n){return t.hasOwnProperty(n)?t[n]:""})}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={html:'\n  <div class="{class}" data-element="overlay" data-visible="false" data-outside-close="{outsideClose}">\n    <div data-element="modal" data-small-width="500">\n      <span data-element="close">Ã—</span>\n      <div data-element="content"></div>\n    </div>\n  </div>\n  ',data:{class:"modi",outsideClose:!0}},e.exports=t.default}])});