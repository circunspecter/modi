!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Modi",[],t):"object"==typeof exports?exports.Modi=t():e.Modi=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(1),o=i(r),l=n(2),u=i(l),c=n(3),d=i(c),f="modal",h=function(){function e(t){a(this,e),t=t||{},this.config=Object.assign({container:document.body,content:null,template:null,data:Object.assign({},t.data)},t),this.template=new u.default(this.config.template||d.default,this.config.data),o.default.container=this.config.container,this.references={},this.listeners=[],this.create(this.config.content)}return s(e,[{key:"show",value:function(e,t){var n=this;t=t||!1,!t&&this.template.methods.show?this.template.methods.show(e,this):this.isVisible()||(e&&(this.content=e),["overlay",f].forEach(function(e){o.default.data.set(n.element(e),"visible",!0)}),o.default.data.set(o.default.container,"modalVisible",!0),this.setFlags(),this.dispatchEvent(this.element(f),"modal:show"))}},{key:"hide",value:function(e){var t=this;e=e||!1,!e&&this.template.methods.hide?this.template.methods.hide(this):this.isVisible()&&(["overlay",f].forEach(function(e){o.default.data.set(t.element(e),"visible",!1)}),o.default.data.set(o.default.container,"modalVisible",!1),this.dispatchEvent(this.element(f),"modal:hide"))}},{key:"relocate",value:function(){this.setFlags(),this.dispatchEvent(this.element(f),"modal:relocate")}},{key:"create",value:function(e){var t=this;this.elements=o.default.appendHtml(this.template.render()),this.elements.forEach(function(e){Object.defineProperty(e,"_Modi",{value:t})}),this.content=e||"",this.element("close")&&this.addListener(this.element("close"),"click",function(){t.hide()}),"true"===o.default.data.get(this.element("overlay"),"outsideClose")&&this.addListener(this.element("overlay"),"click",function(e){"overlay"===e.target.dataset.element&&t.hide()}),this.resizeTimer=null,this.addListener(window,"resize",function(){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){t.relocate()},300)}),this.template.hasEvents()&&this.template.events.forEach(function(e){var n=o.default.getByAttr(e.selector,t.element(f))[0];n&&t.addListener(n,e.type,function(){-1!==["overlay","modal"].indexOf(e.dispatcher)&&(n=t.element(e.dispatcher)),t.dispatchEvent(n,e.name)})})}},{key:"remove",value:function(){var e=this;this.listeners.forEach(function(e){e.element.removeEventListener(e.type,e.listener)}),this.elements.forEach(function(t){e.container.removeChild(t)})}},{key:"isVisible",value:function(){return"true"===o.default.data.get(this.element(f),"visible")}},{key:"element",value:function(e){var t=this;return this.references[e]||(this.references[e]=this.elements.filter(function(t){return t.dataset.element===e})[0]||this.elements.map(function(n){return t.getSubElement(e,n)})[0]||this.getSubElement(e,o.default.container)),this.references[e]}},{key:"getSubElement",value:function(e,t){return o.default.getByAttr('[data-element="'+e+'"]',t)[0]}},{key:"setFlags",value:function(){var e=this,t=!1,n=!1;this.element(f)&&(t=window.innerHeight<this.element(f).offsetHeight,n=parseInt(this.element(f).dataset.smallWidth||0,10),n=n>0&&window.matchMedia("(max-width: "+n+"px)").matches),["overlay",f].forEach(function(i){o.default.data.set(e.element(i),"smallHeightFlag",t),o.default.data.set(e.element(i),"smallWidthFlag",n)})}},{key:"addListener",value:function(e,t,n){e&&(e.addEventListener(t,n),this.listeners.push({element:e,type:t,listener:n}))}},{key:"dispatchEvent",value:function(e,t,n){e&&(n=Object.assign({instance:this,overlay:this.element("overlay"),modal:this.element(f)},n),this.template.listeners[t]&&this.template.listeners[t](n),o.default.event.dispatch(e,t,n))}},{key:"content",get:function(){return this.element("content")?this.element("content").innerHTML:void 0},set:function(e){e&&this.element("content")&&(this.element("content").innerHTML=e)}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={container:document.body,stringToElements:function(e){var t=document.createElement("div");return t.innerHTML=e,t.children},appendElements:function(e,t){var n=[].slice.call(e),i=document.createDocumentFragment();return Array.from(e).forEach(function(e){i.appendChild(e)}),(t||this.container).appendChild(i),n},appendHtml:function(e,t){return this.appendElements(this.stringToElements(e),t)},getByAttr:function(e,t){return t=t||this.container,t.querySelectorAll(e)},style:{set:function(e,t,n){e.style.setProperty(t,n)},remove:function(e,t){e.style.removeProperty(t)}},event:{dispatch:function(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:n}))}},data:{get:function(e,t){return(e||{}).dataset?e.dataset[t]:void 0},set:function(e,t,n){(e||{}).dataset&&(e.dataset[t]=n)}}},e.exports=t.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t,n){i(this,e),this.html=t.html||"",this.data=Object.assign({},t.data,n),this.events=t.events||{},this.listeners=t.listeners||{},this.methods=t.methods||{}}return a(e,[{key:"hasEvents",value:function(){return this.events.constructor===[].constructor&&this.events.length}},{key:"render",value:function(){var e=this;return this.html.replace(/{([^{}]+)}/g,function(t,n){return e.data.hasOwnProperty(n)?e.data[n]:""})}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={html:'\n  <div class="{class}" data-element="overlay" data-visible="false" data-outside-close="{outsideClose}">\n    <div data-element="modal" data-small-width="500">\n      <span data-element="close">Ã—</span>\n      <div data-element="content"></div>\n    </div>\n  </div>\n  ',data:{class:"modi",outsideClose:!0}},e.exports=t.default}])});